== Third Party Ingestion

// Only supports periodic scans - not PR scans etc
// Not supported. History , Deduplication, DevEx features - PR comments, IDE, CLI, Enforcement

// Ingest findings from 3rd parties
// Display findings in Projects > 3rd Party Weaknesses
// Display findings aad metadata across all relevant pages such as Repositories, Dashboards and so on, Running another vendor’s scanner from our backend or in our integrations, Decorating reachability and runtime contextualization on ingested findings

//As a user, I would like to be able to ingest scan results from Checkmarx into Prisma Cloud, in order to bring scans from my different security tools into a single platform.
//Permissions:  System Admin or AppSec Admin or GRBAC permissions 
// Onboard 3rd party ingestion: onboard Checkmarx into Prisma Cloud from the Providers > 3rd Party tab by adding an API key. - need to display the onboarding wizard process

// Validate API key. validate that the API key I add is valid and has the correct permissions. If not, I would like the wizard to not advance and show an error message about the API key failure. Validation -  before turning on the integration. Permissions for the key: Read only - check with Taylor

// (After onboarding )Retrieve the projects from Checkmarx - As a user, I would like to have a list of Checkmarx Projects to add to Prisma Cloud, in order to add all Projects or only select Projects. THis is through mapping Checkmarx projects with repos that the client has onboarded to Prisma CLoud. The benefits of mapping are : in places like the repositories page we can show the SAST findings. Also for ASPM etc in the future we can have runtime context for Checkmarx findings 

//Confirm connection status - As a user, once integration is complete, I would like to test my connection and manually trigger data ingestion to the vendor (e.g., Checkmarx) from the Providers page, in order to ensure reliable connectivity and data exchange.  Failures to connect will be displayed as a column in the provider table. Our Periodic scans will not fail if ingesting fails.

// Automatic ingestion: Begin ingestion automatically - As a user, I would like the ingestion will begin automatically after completing the wizard, in order to have the ingestion of Checkmarx data to be added to Prisma Cloud .

// Associate Checkmarx projects to CAS repositories - As a user, I would like to be able to associate the ingested projects with a repository onboarded in CAS in order to reduce the number of duplicated Repositories. Map repos  while giving me the ability manually change that mapping.


// Trigger Ingestion: manually trigger an ingestion across all projects. I would like to do this from the Providers page and via the Projects > Scan Now feature.

// Findings:  Findings to be displayed in the Projects page.THere is a tab to filter for 3rd party ingestion: “3rd Party Weaknesses” (same as repo page). Findings will be both group by policy and group by resource. In the sidecar under Issues, there will be additional data from Checkmarx including their Compliance, Confidence Level and Source. Clicking on the source icon will take you to Checkmarx- to the specific finding. THe code snippet for a fix is not presented as it is not fetched from Checkmarx in their API response, All new findings from Checkmarx scans to be updated in Prisma Cloud with our Periodic flow every 12 hours. This includes only Periodic scans. As a user, I would like to be able to see my ingested scan results in the Overview tab and new “3rd Party Weaknesses”. We will add a row for Compliance that will show Compliance frameworks from Checkmarx and Confidence that will show the Checkmarx Confidence score. There will be a multi-select filter for Source. The steps or “nodes” will be displayed in the sidecar and link out to the VCS if mapped. The Source row in the sidecar will be linked to the finding in Checkmarx. Each node has a file a line number and function call, linked to the vcs provider. Suppression  (ckeck whether it is in the mvp=beta). Clicking on Suppress should suppress the finding on both the Prisma Cloud as well as Checkmarx platforms.

// Filters: Repositories - this will be the name of the repository as we store it if it’s mapped, the project org/project from the vendor if it wasn’t mapped
////
Branch - default and grayed out for now

Code Categories - “3rd Party Weaknesses”

Issue Status - same as it is for our findings

CWEs - In our format so it aligns to the Weaknesses tab

Compliance - A closed list of the compliance labels we get from the vendor

Severities - same as others

File Type - applies to the finding file or last node (sink) from Checkmarx
////


// Display findings and metadata on Repositories

////
 Show Ingested findings' metadata to be shown on the Repositories page to have a high level summary of the number of findings. The count for SAST will include ingested numbers with duplicates when multiple scanners are used. For example, if the customer uses Prisma Cloud’s SAST and Checkmarx and both vendors find the same finding in code, then the count for SAST will be 2. Hovering over the number will show a breakdown by source (e.g., Checkmarx: 20, Prisma Cloud: 10).

If my project is not mapped to a repository, I would like it to be shown on Repositories as a new repository with the information that is known. 
////

////
Display findings and metadata on Dashboards 
As a user, I would like the scan results data from Checkmarx to be in our Dashboard widgets that have SAST data. I would like to have  Source as a filter in case I do not want a certain vendor’s findings in the widget.
////

// Failure management?