== On Premises Health Check
On-Premises Health Checks
The health check provides information about connectivity with your on-premises (on-prem) environment, including the most recent connection establishment time. Automatic Health checks are run every hour.  
Verify On-Prem Connectivity 
Access your on-prem integration: Settings > Advanced Deployments > On-Prem Connection.

Under Alias, select your on-prem deployment.
The on-prem deployment connectivity status is displayed.

Health Checks
You can perform the following on-prem connectivity health checks.
Refresh On-Prem connectivity 
If you are disconnected you can perform a connectivity refresh.
Access the on-prem deployment connectivity status - see Verify On-Prem Connectivity above.
Select the Refresh icon to perform a connectivity check. The result is displayed in the UI.



Verify On-Prem Connectivity with Ingress
This check verifies network level accessibility, including routes, firewall rules, and access lists. Ensure that the host used for configuration has access to the specified Ingress URL using the domain name and port defined by the customer for the ingress.
Run: curl -X GET https://ingress.url.com:443/healthz -k
Verify On-Prem Connectivity without Ingress
To verify on-prem connectivity without ingress, access the Transporter Client pod on Kubernetes (K8s), and send the request from there:
Run kubectl get pods to find the Transporter Client pod name.
Connect to the Transporter Client pod: kubectl exec -it -c transporter POD_NAME -- sh. 
Example: kubectl exec -it -c transporter transporter-76c74b54cb-hnd5n -- sh.
After connecting to the Transporter Client, run curl -X GET https://localhost:8080/healthz -k.
Success response: {‘ok’:true}.
Verify Workload Manager Connectivity
Verify the K8s Workload Manager connectivity status.
Requirement: The Transporter must be connected in order to check Workload Manager connectivity. 
Execute steps 1,2 of Verify Transporter (Tunnel) connectivity from the Prisma Cloud platform above.
Verify that the Workload Manager has established a connection.



Troubleshoot Workload Manager Connectivity
If the Workload Manager is not connected, perform the following checks.
Verify that the Workload Manager pods are up and running: Run kubectl get pods. 
Tip: Search for on-prem-workload-mgr-k8s-....

If the Workload Manager is not running, run kubectl describe pod on-prem-workload-mgr-k8s-....to further understand the issue.













// Raw Content from Tomer Eskenazi 




Transporter:


on-prem integration ui - check healthcheck status


verify that transporter pods are up
kubectl get pods (search for transporter-...)
verify pods are on Running status


if not Running:
kubectl describe pod transporter-....


with ingress:
url and port defined by the customer


curl -X GET https://ingress.url.com:443/healthz -k


without ingress:
need to connect to transporter client pod on K8s, and send the request from there


kubectl get pods (find the transporter pod name)


connect to transporter pod:
kubectl exec -it -c transporter POD_NAME -- sh
kubectl exec -it -c transporter transporter-76c74b54cb-hnd5n -- sh


curl -X GET https://localhost:8080/healthz -k


success response - {"ok":true}




Workload Manager:


on-prem integration ui - check healthcheck status


verify that workload manager pods are up
kubectl get pods (search for on-prem-workload-mgr-k8s-...)
verify pods are on Running status


if not Running:
kubectl describe pod on-prem-workload-mgr-k8s-....
